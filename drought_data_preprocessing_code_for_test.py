# -*- coding: utf-8 -*-
"""drought_data_preprocessing_code_for_test

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NRwgt-Xk0zPs6MyYLcj20cQQYIw3Gstp

# Mount the google drive
"""

from google.colab import drive
drive.mount('/content/drive', force_remount=True)
import numpy as np
import pandas as pd

"""# Read the raw file"""

path = '/content/drive/Shareddrives/1:1 Clarisse/drought/test_timeseries/test_timeseries.csv'
df = pd.read_csv(path)
print('Number of samples: ', len(df))

"""# View the dataframe"""

df.head()

"""# Drop the NA values"""

df_noNa = df.dropna(how='any')

"""# Find the max and min values in the score columns"""

print(df_noNa["score"].max()) #finds max
print(df_noNa["score"].min()) #finds min

"""# Convert the score value to drought levels specified by https://droughtmonitor.unl.edu/ """

df_noNa["score"] = pd.cut(x = df_noNa["score"], bins = [0, 1, 2, 3, 4, 5], labels = ['D0', 'D1', 'D2', 'D3', 'D4'])

df_noNa.to_csv('/content/drive/Shareddrives/1:1 Clarisse/drought/processed_test_timeseries.csv', index=False)